---

- name: ensure resolv.conf has localhost resolver
  blockinfile:
    dest: /etc/sysconfig/network-scripts/ifcfg-eth0
    block: |
      PEERDNS=no
      DNS1=127.0.0.1
    marker: "# {mark} ANSIBLE MANAGED BLOCK: local dns"
#  notify:
#    - restart network

- name: ensure bind active
  service: name={{ bind_svc }} state=started

- name: direct change of /etc/resolv.conf to avoid restarting network
  lineinfile:
    dest: /etc/resolv.conf
    regexp: '^nameserver .*'
    line: 'nameserver 127.0.0.1'
    insertafter: '; generated by '
